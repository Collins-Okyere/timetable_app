<div  *ngIf="tableData?.type" class="px-4 sm:px-6 lg:px-8  bg-gray-50 min-h-full">

    <div  *ngIf="tableData.type !== 'detail_list'" class="w-full">
        
        <div class="sm:flex sm:items-center justify-between mx-2 pt-6 {{tableData?.type === 'mark_attendance' ? 'flex justify-between' : ''}}">
        
            <!-- Special Actions -->
            <div class="flex items-center space-x-16">

                <div class="sm:flex-auto">

                    <h1><span class="text-xl font-semibold text-gray-900 whitespace-nowrap" [innerHTML]="(tableData?.title | capitalizeWords) || 'List'"></span></h1>
                    
                    <p><span class="mt-2 text-sm text-gray-700 whitespace-nowrap" [innerHTML]="tableData?.description || ''"></span></p>

                </div>

                <!-- Person / Person Transfers-->
                <div *ngIf="tableData?.transfer" class="min-w-full">
                    <div for="transfer" class="text-sm flex items-center ">{{tableData?.transfer?.title}}: </div>
                    <div class="mt-1">
                        <app-select-input class="min-w-full" id="transfer" [selectInputData]="{ items: tableData?.transfer?.data, placeholder: tableData?.transfer?.placeholder, multiple: false, displayProperty: 'name', searchProperty: 'name', autoClose: true }" (selectionChanged)="onSelectionChanged('selected_branch', $event)"></app-select-input>
                    </div>
                </div>

                <!-- Person / Person Groups Management-->
                <div *ngIf="tableData?.type === 'manage_groups'" class="flex items-center space-x-6">
            
                    <div>
                        <div for="action" class="text-sm flex items-center whitespace-nowrap">Select Action: </div>
                        <div class="mt-1">
                            <app-select-input class="min-w-full" id="action" [selectInputData]="{ items: ['Assign To Group', 'Remove From Group', 'Move From Group'], placeholder: 'Select Ministry / Group', multiple: false, displayProperty: 'name', searchProperty: 'name', autoClose: true }" (selectionChanged)="onSelectionChanged('group_action', $event)"></app-select-input>
                        </div>
                    </div>
            
                    <div *ngIf="tableData?.type === 'manage_groups' && selectedAction">
                        <div for="group" class="text-sm flex items-center whitespace-nowrap">{{selectedAction === 'Move From Group' ? 'Move Persons From' : 'Select Ministry / Group'}}: </div>
                        <div class="mt-1">
                            <app-select-input *ngIf="refresh" class="min-w-full" id="group" [selectInputData]="{ items: this.groups, placeholder: 'Select Ministry / Group', multiple: false, displayProperty: 'name', searchProperty: 'name', defaultValue: selectedGroup, autoClose: true }" (selectionChanged)="onSelectionChanged('selected_group', $event)"></app-select-input>
                        </div>
                    </div>
            
                    <div *ngIf="tableData?.type === 'manage_groups' && selectedAction === 'Move From Group' && this.refresh2 ">
                        <div for="receipient_group" class="text-sm flex items-center whitespace-nowrap">Move Persons To: </div>
                        <div class="mt-1">
                            <app-select-input *ngIf="selectedAction === 'Move From Group' && this.refresh2" class="min-w-full" id="receipient_group" [selectInputData]="{ items: this.filteredGroups, placeholder: 'Select Ministry / Group', multiple: false, displayProperty: 'name', defaultValue: receipientGroup, searchProperty: 'name', autoClose: true }" (selectionChanged)="onSelectionChanged('receipient_group', $event)"></app-select-input>
                        </div>
                    </div>

                </div>
                
                
            </div>

            <div *ngIf="showTable && tableData" class="sm:mt-0 sm:ml-16 flex items-center space-x-4">

                <!-- <app-download-button *ngIf="tableData?.canDownload" [downloadData]="downloadData"></app-download-button> -->
                
                <button *ngIf="tableData?.canUpload" (click)="bulkUpload()" type="button" class="inline-flex items-center justify-center rounded-md border border-transparent bg-indigo-50 px-4 py-2 text-sm font-medium text-indigo-700 shadow-sm hover:bg-indigo-100 space-x-1 whitespace-nowrap focus:shadow-md">
                    <span class="text-2xl mr-1">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6"><path stroke-linecap="round" stroke-linejoin="round" d="M9 8.25H7.5a2.25 2.25 0 0 0-2.25 2.25v9a2.25 2.25 0 0 0 2.25 2.25h9a2.25 2.25 0 0 0 2.25-2.25v-9a2.25 2.25 0 0 0-2.25-2.25H15m0-3-3-3m0 0-3 3m3-3V15" /></svg>
                    </span> 
                    <span class="mt-1">Bulk Upload</span>
                </button>

                <button *ngIf="tableData?.canAdd" class="shadow-sm hover:shadow-md shadow-gray-400 bg-indigo-700 hover:bg-indigo-600 text-white text-sm px-3 py-2 rounded" (click)="openModal()">+ Add {{tableData.tag ?? 'New' | capitalizeWords}}</button>
                
            </div>

            <div *ngIf="showTable && tableData && tableData?.type === 'mark_attendance'" class="flex items-center justify-end space-x-6">

                <div class="flex items-center space-x-1">
                    <label for="simpleForm" class="ml-2 block text-md text-gray-700"> Add Time </label>
                    <input type="checkbox" *ngIf="refreshToggles" class="toggle toggle-sm toggle-primary" [checked]="toggles.addTime" (change)="toggleFnx('addTime')" />
                </div>
                                
                <div class="flex items-center space-x-1">
                    <label for="simpleForm" class="ml-2 block text-md text-gray-700"> Add Absent Reason </label>
                    <input type="checkbox" *ngIf="refreshToggles" class="toggle toggle-sm toggle-primary" [checked]="toggles.addReason" (change)="toggleFnx('addReason')" />                    
                </div>
            
            </div>

        </div>

        <div *ngIf="showTable && tableData && tableData?.advancedFilters" class="flex justify-start items-center space-x-3 pt-2 px-3">
                        
            <div class="w-1/4">                    
                <div for="group_by" class="text-xs flex items-center ">Group By: </div>
                <div class="mt-1">
                    <app-select-input *ngIf="!refresh" class="min-w-full" id="group_by" [selectInputData]="{ items: initFields, placeholder: 'Group Table By', multiple: false, bgColor: 'bg-indigo-800', displayProperty: 'name', searchProperty: 'name', defaultValue: initFields[0] ?? null, autoClose: true }" (selectionChanged)="onSelectionChanged('group_by', $event)"></app-select-input>
                </div>
            </div>
                        
            <div class="w-3/4">                    
                <div for="display_fields" class="text-xs flex items-center ">Display Fields: </div>
                <div class="mt-1">
                    <app-select-input class="min-w-full" id="display_fields" [selectInputData]="{ items: allTableFields, searchable: false, placeholder: 'Select Fields To Display', bgColor: 'bg-indigo-800', displayProperty: 'name', searchProperty: 'name', multiple: true, autoClose: true, defaultValue: selectedFields }" (selectionChanged)="onSelectionChanged('selected_fields', $event)"></app-select-input>
                </div>
            </div>

        </div>
    
        <div *ngIf="showTable && tableData && tableHeaders" class="mt-4 w-full overflow-x-auto inline-block min-w-full p-2 align-middle pb-40 ">
            <div class="shadow ring-1 ring-black ring-opacity-5 md:rounded-lg">

                <div class="min-w-full flex justify-end items-center bg-indigo-800 space-x-12">
                    
                    <div *ngIf="tableData?.canSearch" class="flex justify-end relative p-2 w-1/3">
                        <input type="text" [(ngModel)]="searchValue" (ngModelChange)="onSearch()" placeholder="Search here (3 Char. min)" class="pl-14 pr-4 py-2 w-full text-sm text-slate-600 rounded-lg border border-slate-300 font-light outline-none" />
                        <span class="absolute inset-y-0 left-4 flex items-center pointer-events-none text-slate-400">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-8 h-8 border-r pl-1 pr-2">
                                <path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" />
                            </svg>
                        </span>
                    </div>

                </div>
                
                <table class="min-w-full divide-y divide-gray-300">
                
                    <thead class="bg-indigo-800">

                        <tr>

                            <th class="whitespace-nowrap px-3 py-3.5 text-left text-sm font-semibold text-white">
                                SN
                            </th>

                            <th *ngFor="let key of tableHeaders" class="whitespace-nowrap px-3 py-3.5 text-left text-sm font-semibold text-white">
                                
                                <div class="flex items-center space-x-6">
                                    
                                    <span>{{ key | capitalizeWords }}</span>

                                    <button (click)="sortData(key)" class="text-sm flex flex-col space-0">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="4" fill="currentColor" class="size-3">
                                            <path fill-rule="evenodd" d="M11.47 7.72a.75.75 0 0 1 1.06 0l7.5 7.5a.75.75 0 1 1-1.06 1.06L12 9.31l-6.97 6.97a.75.75 0 0 1-1.06-1.06l7.5-7.5Z" clip-rule="evenodd" />
                                        </svg>
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="4" fill="currentColor" class="size-3">
                                            <path fill-rule="evenodd" d="M12.53 16.28a.75.75 0 0 1-1.06 0l-7.5-7.5a.75.75 0 0 1 1.06-1.06L12 14.69l6.97-6.97a.75.75 0 1 1 1.06 1.06l-7.5 7.5Z" clip-rule="evenodd" />
                                        </svg>
                                    </button>

                                </div>
                                
                            </th>

                            <th *ngIf="tableData?.canEdit || tableData?.canDelete || tableData?.checkbox || tableData?.type === 'mark_attendance'" class="flex items-center space-x-2 whitespace-nowrap px-3 py-3.5 text-right justify-end text-sm font-semibold text-white">
                                <span>{{tableData?.checkbox ? tableData?.checkTitle ?? 'Add / Remove' : tableData?.type === 'mark_attendance' ? 'Mark Attendance' :  'Actions'}}</span>
                                <input *ngIf="tableData?.checkbox && (groupPersons?.length > 0 || tableData?.data?.length > 0)" type="checkbox" [checked]="checkedAll" [disabled]="!tableData?.edit" (change)="onCheckboxChange({}, $event)" class="accent-indigo-100  {{tableData?.type === 'mark_attendance' ? 'h-5 w-5' : 'h-4 w-4'}} rounded-md" />
                            </th>

                            <th *ngIf="tableData?.type === 'mark_attendance' && toggles.addTime === true" class="whitespace-nowrap px-3 py-3.5 text-center text-sm font-semibold text-white">
                                <span>Time</span>
                            </th>

                            <th *ngIf="tableData?.type === 'mark_attendance'  && toggles.addReason" class="whitespace-nowrap px-3 py-3.5 text-center text-sm font-semibold text-white">
                                <span>Absent Reason</span>
                            </th>

                    </thead>
                    

                    <tbody *ngIf="tableData?.type === 'general'" class="divide-y divide-gray-200 bg-white">
                        
                        <tr  *ngFor="let item of tableData?.data; let i = index" class="hover:bg-gray-50">
                            
                            <td class="whitespace-nowrap p-3 font-bold text-sm text-gray-900">
                                {{ i+1 }}.
                            </td>

                            <td *ngFor="let key of keys" class="whitespace-nowrap p-3 text-gray-900">

                                <div *ngIf="!Array.isArray(item[key])" class="whitespace-nowrap text-sm space-x-2 flex items-center">

                                    <div *ngIf="item[key]?.photo || item[key]?.image || item[key]?.logo || item[key]?.flag || isImageUrl(item[key])" class="avatar">
                                        <div class="mask mask-squircle h-8 w-8">
                                            <img [src]="item[key]?.photo ?? item[key]?.image ?? item[key]?.logo ?? item[key]?.flag ?? item[key]">
                                        </div>
                                    </div>
        
                                    <div class="space-y-1" [ngClass]="{'text-gray-400': !item[key]?.name || !item[key], 'text-gray-900': item[key]?.name || item[key], 'hidden': isImageUrl(item[key])}">
                                        <div class="font-medium whitespace-nowrap text-sm">{{ item[key]?.name ?? ( item[key]?.first_name ? item[key]?.first_name + ' ' + (item[key]?.other_names ? item[key]?.other_names + ' ' : '') + (item[key]?.last_name ?? '') : item[key] ) ?? '(Empty)' }}</div>
                                        <div *ngIf="item[key]?.member_id || item[key]?.staff_id" class="text-gray-400">ID: <span class="text-gray-500">{{item[key]?.member_id ?? item[key]?.staff_id}}</span></div>
                                    </div>

                                </div>
                            
                                <div *ngIf="Array.isArray(item[key])" class="text-sm space-y-1">
                                    <ul class="text-sm space-y-1">
                                        <li *ngFor="let subItem of item[key]" class="flex flex-wrap items-center space-x-1">
                                            <span [ngClass]="{'text-gray-400': !subItem?.name || !subItem}"> {{ subItem?.name ? '• ' + subItem.name : subItem && !subItem.name ? '• ' + subItem : '(Empty)' }} </span>
                                        </li>
                                    </ul>
                                </div>   

                            </td>

                            <td *ngIf="tableData?.canEdit || tableData?.canDelete" class="whitespace-nowrap p-3 text-right text-xs font-medium space-x-2">
                                <div *ngIf="tableData?.dropMenu" class="dropdown dropdown-bottom dropdown-end">
                                    <div tabindex="0" role="button" class="z-0 relative py-1.5 px-3 flex items-center whitespace-nowrap text-xs rounded bg-indigo-50 text-indigo-700 hover:bg-indigo-100">
                                        Actions 
                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 12.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 18.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5Z" /></svg>
                                    </div>
                                    <ul tabindex="0" class="dropdown-content menu bg-white rounded-box z-50 w-32 p-2 shadow-sm text-xs">
                                    <li class="hover:bg-indigo-50 rounded-lg" (click)="openModal(item, false)"><a>View</a></li>
                                    <li *ngIf="tableData?.canEdit" class="hover:bg-indigo-50 rounded-lg" (click)="openModal(item)"><a>Edit</a></li>
                                    <li *ngIf="tableData?.canDownload" class="hover:bg-indigo-50 rounded-lg" (click)="singleDownload(item)"><a>Download</a></li>
                                    <li *ngIf="tableData?.canDelete" class="hover:bg-indigo-50 rounded-lg text-red-600" (click)="openConfirmModal(item)"><a>Delete</a></li>
                                    </ul>
                                </div>
                                <button *ngIf="!tableData?.dropMenu && tableData?.canEdit" class="py-1.5 px-5 rounded bg-indigo-50 text-indigo-700 hover:bg-indigo-100" (click)="openModal(item)">Edit</button>
                                <button *ngIf="!tableData?.dropMenu && tableData?.canDelete" class="py-1.5 px-2 rounded bg-red-50 text-red-700 hover:bg-red-100" (click)="openConfirmModal(item)">Delete</button>
                            </td>

                            <td *ngIf="tableData?.checkbox" class="whitespace-nowrap p-3 text-right text-xs font-medium space-x-2">
                                <input type="checkbox" [checked]="item.checked" [disabled]="!tableData?.edit" [name]="item.id" (change)="onCheckboxChange(item, $event)" [id]="item.id" class="accent-indigo-700 h-4 w-4 rounded-md">
                            </td>

                        </tr>

                        <tr *ngIf="tableData?.data?.length === 0">
                            <td colspan="100%" class="text-center text-gray-400 py-4">No data available</td>
                        </tr>      

                    </tbody>

                    <tbody *ngIf="tableData?.type === 'user_list' || tableData?.type === 'manage_groups'" class="h-full overflow-auto divide-y divide-gray-100 bg-white">
                    
                        <tr *ngFor="let item of tableData?.data; let i = index" class="hover:bg-gray-50 cursor-pointer bg-white h-16 py-2">
                            
                        <td class="whitespace-nowrap p-3 font-bold text-sm text-gray-900">
                            {{ i+1 }}.
                        </td>
    
                        <td>
                            <div class="flex items-center gap-3">
                            
                                <div class="avatar">
                                    <div class="mask mask-squircle h-10 w-10">
                                        <img [src]="item.photo" alt="Avatar" />
                                    </div>
                                </div>
    
                                <div class="text-xs">
                                    <div class="font-medium whitespace-nowrap text-sm">{{item.title ?? ''}} {{item.first_name ?? ''}} {{item.other_names ?? ''}} {{item.last_name ?? ''}} {{item.name ?? ''}}</div>
                                    <div class="text-gray-400">ID: <span class="text-gray-500">{{item.member_id ?? item.staff_id}}</span></div>
                                </div>
    
                            </div>
                        </td>
    
                        <td class="text-gray-600 whitespace-nowrap text-xs">
                            <div class="whitespace-nowrap">{{item.phone1 ? item.phone1 : '(No Number)'}} {{item.phone2 ? ' / ' + item.phone2 : ''}} </div>
                            <!-- <div class="whitespace-nowrap">{{item.phone1 ? item.phone1 : '(No Number)'}}</div>
                            <div *ngIf="item.phone2" class="whitespace-nowrap">{{item.phone1}}</div> -->
                            <div>{{item.email ? item.email : '(No Email)'}}</div>
                        </td>
    
                        <td class="text-gray-600 whitespace-nowrap text-xs">
                            <div>{{item.branch.name}} ({{item.branch.abbreviation}})</div>
                            <div *ngIf="item?.position || item?.positions?.length > 0">({{ item?.position ?? item.positions[0].name ?? '' }})</div>
                        </td>

                            <td *ngIf="tableData?.checkbox" class="whitespace-nowrap p-3 text-right text-xs font-medium space-x-2">
                                <input type="checkbox" [(ngModel)]="item.checked" [disabled]="!tableData?.edit" [name]="item.id" (change)="onCheckboxChange(item, $event)" [id]="item.id" class="accent-indigo-700 {{tableData?.type === 'mark_attendance' ?'h-5 w-5' : 'h-4 w-4'}} rounded-md">
                            </td>

                            <td *ngIf="item.time" class="whitespace-nowrap p-3 text-center text-xs font-medium space-x-2">
                                <input type="time" [(ngModel)]="item.time" (ngModelChange)="updateAttendance()" [disabled]="!tableData?.edit" [name]="item.id" [id]="item.id" class="min-w-0 w-full bg-white border border-slate-300 rounded-md shadow-sm py-2 px-4 text-base text-slate-900 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500" />
                            </td>

                        <td *ngIf="tableData?.dropMenu" class="whitespace-nowrap p-3 text-right text-xs font-medium space-x-2 relative">
                            <div class="dropdown dropdown-bottom dropdown-end">
                                    <div tabindex="0" role="button" class="z-0 relative py-1.5 px-3 flex items-center whitespace-nowrap text-xs rounded bg-indigo-50 text-indigo-700 hover:bg-indigo-100">
                                        Actions 
                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 12.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 18.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5Z" /></svg>
                                    </div>
                                    <ul tabindex="0" class="dropdown-content menu bg-white rounded-box z-50 w-32 p-2 shadow-sm text-xs">
                                    <li class="hover:bg-indigo-50 rounded-lg" (click)="openModal(item, false)"><a>View</a></li>
                                    <li class="hover:bg-indigo-50 rounded-lg" *ngIf="tableData?.canEdit" (click)="openModal(item)"><a>Edit</a></li>
                                    <li class="hover:bg-indigo-50 rounded-lg" *ngIf="tableData?.canDownload" (click)="singleDownload(item)"><a>Download</a></li>
                                    <li class="hover:bg-indigo-50 rounded-lg text-red-600" *ngIf="tableData?.canDelete" (click)="openConfirmModal(item)"><a>Delete</a></li>
                                    </ul>
                                </div>
                            <button *ngIf="!tableData?.dropMenu && tableData?.canEdit" class="py-1.5 px-5 rounded bg-indigo-50 text-indigo-700 hover:bg-indigo-100" (click)="openModal(item)">Edit</button>
                            <button *ngIf="!tableData?.dropMenu && tableData?.canDelete" class="py-1.5 px-2 rounded bg-red-50 text-red-700 hover:bg-red-100" (click)="openConfirmModal(item)">Delete</button>
                        </td>
    
                        </tr>

                        <tr *ngIf="tableData?.data?.length === 0 || groupPersons?.length === 0">
                            <td colspan="100%" class="text-center text-gray-400 py-4">No data available</td>
                        </tr>
                    
                    </tbody>

                    <tbody *ngIf="tableData?.type === 'mark_attendance'" class="h-full overflow-auto divide-y divide-gray-100 bg-white">
                    <tr *ngFor="let item of tableData?.data; let i = index" class="hover:bg-gray-50 cursor-pointer bg-white h-16 py-2">
                            
                        <td class="whitespace-nowrap p-3 font-bold text-sm text-gray-900">
                            {{ i+1 }}.
                        </td>
    
                        <td>
                            <div class="flex items-center gap-3">
                            
                                <div class="avatar">
                                    <div class="mask mask-squircle h-10 w-10">
                                        <img [src]="item.photo" alt="Avatar" />
                                    </div>
                                </div>
    
                                <div class="text-xs">
                                    <div class="font-medium whitespace-nowrap text-sm">{{item.title ?? ''}} {{item.first_name ?? ''}} {{item.other_names ?? ''}} {{item.last_name ?? ''}} {{item.name ?? ''}}</div>
                                    <div class="text-gray-400">ID: <span class="text-gray-500">{{item.member_id ?? item.staff_id}}</span></div>
                                </div>
    
                            </div>
                        </td>

                            <td *ngIf="tableData?.checkbox" class="whitespace-nowrap p-3 text-right text-xs font-medium space-x-2">
                                <input type="checkbox" [(ngModel)]="item.checked" [disabled]="!tableData?.edit" [name]="item.id" (change)="onCheckboxChange(item, $event)" [id]="item.id" class="accent-indigo-700 {{tableData?.type === 'mark_attendance' ?'h-5 w-5' : 'h-4 w-4'}} rounded-md">
                            </td>

                            <td *ngIf="toggles.addTime" class="whitespace-nowrap p-3 text-center text-xs font-medium space-x-2">
                                <input *ngIf="item.checked" type="time" [(ngModel)]="item.check_in_time" (ngModelChange)="updateAttendance()" [disabled]="!tableData?.edit" [name]="item.id" [id]="item.id" class="min-w-0 w-full bg-white border border-slate-300 rounded-md shadow-sm py-2 px-4 text-base text-slate-900 focus:outline-none focus:border-indigo-500 focus:ring-1 focus:ring-indigo-500" />
                            </td>

                            <td *ngIf="toggles.addReason" class="whitespace-nowrap p-3 text-center text-xs font-medium space-x-2">
                                <textarea rows="3" *ngIf="!item.checked" [(ngModel)]="item.absence_reason" (ngModelChange)="updateAttendance()" [disabled]="!tableData?.edit" placeholder="Enter Absent Reason" [name]="item.id" [id]="item.id" class=" m-1 py-2 px-3 block w-full border rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"></textarea>
                            </td>
    
                    </tr>

                    <tr *ngIf="tableData?.data?.length === 0">
                        <td colspan="100%" class="text-center text-gray-400 py-4">No data available</td>
                    </tr>
                    
                    </tbody>

                    <tbody *ngIf="tableData?.type === 'attendance_report' " class="divide-y divide-gray-200 bg-white">
                        <tr  *ngFor="let item of tableData?.data; let i = index" class="hover:bg-gray-50">
                            
                            <td class="whitespace-nowrap p-3 font-bold text-sm text-gray-900">
                                {{ i+1 }}.
                            </td>

                            <td *ngFor="let key of keys" class="whitespace-nowrap p-3 text-gray-900">

                                <div class="whitespace-nowrap text-sm space-x-2 flex items-center">

                                    <div *ngIf="key === 'member'" class="avatar">
                                        <div class="mask mask-squircle h-12 w-12">
                                            <img [src]="item[key]?.photo">
                                        </div>
                                    </div>
        
                                    <div class="space-y-1" [ngClass]="{'text-gray-400': !item[key], 'text-gray-900': item[key]}">
                                        
                                        <div *ngIf="key === 'member'">
                                            <div class="font-medium whitespace-nowrap text-sm items-center flex space-x-2">
                                                <span>{{  item[key]?.first_name  + ' ' + item[key]?.other_names  + ' ' + item[key]?.last_name }}</span>  <span class="text-gray-500">({{item[key]?.member_id ?? item[key]?.staff_id}})</span>
                                            </div>
                                            <!-- <div class="text-gray-400">ID: <span class="text-gray-600">{{item[key]?.member_id ?? item[key]?.staff_id}}</span></div> -->
                                            <!-- <div class="text-gray-400">Attendance: <span class="text-gray-600">6/12</span></div> -->
                                            <div class="text-gray-400">Phone: <span class="text-gray-600">{{item[key]?.phone1 ? item[key]?.phone1 : '(No Number)'}} {{item[key]?.phone2 ? ' / ' + item[key]?.phone2 : ''}}</span></div>
                                        </div>

                                        <div *ngIf="key !== 'member'" class="text-gray-400 items-center flex space-x-2">
                                            <span>
                                                <svg *ngIf="item[key]?.is_present" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="4.0" stroke="currentColor" class="size-5 text-indigo-700">
                                                    <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5" />
                                                </svg>
                                                <svg *ngIf="!item[key]?.is_present" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="4.0" stroke="currentColor" class="size-5 text-red-700">
                                                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
                                                </svg>
                                            </span>
                                            <span *ngIf="item[key]?.check_in_time" class="text-indigo-700 text-md">{{item[key]?.check_in_time}}</span>
                                        </div>

                                        <!-- <div *ngIf="item[key]?.absence_reason || item[key]?.check_in_time" [ngClass]="{'text-indigo-700': item[key]?.check_in_time, 'text-gray-400': item[key]?.absence_reason}">({{item[key]?.absence_reason ?? item[key]?.check_in_time}})</div> -->
                                        <div *ngIf="item[key]?.absence_reason" [ngClass]="{'text-gray-400': item[key]?.absence_reason}">({{item[key]?.absence_reason}})</div>
                                        
                                    </div>

                                </div>  

                            </td>

                            <td *ngIf="tableData?.dropMenu" class="whitespace-nowrap p-3 text-right text-xs font-medium space-x-2">
                                <div class="dropdown dropdown-bottom dropdown-end">
                                    <div tabindex="0" role="button" class="z-0 relative py-1.5 px-3 flex items-center whitespace-nowrap text-xs rounded bg-indigo-50 text-indigo-700 hover:bg-indigo-100">
                                        Actions 
                                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 12.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 18.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5Z" /></svg>
                                    </div>
                                    <ul tabindex="0" class="dropdown-content menu bg-white rounded-box z-50 w-32 p-2 shadow-sm text-xs">
                                    <li class="hover:bg-indigo-50 rounded-lg" (click)="openModal(item, false)"><a>View</a></li>
                                    <li *ngIf="tableData?.canEdit" class="hover:bg-indigo-50 rounded-lg" (click)="openModal(item)"><a>Edit</a></li>
                                    <li *ngIf="tableData?.canDownload" class="hover:bg-indigo-50 rounded-lg" (click)="singleDownload(item)"><a>Download</a></li>
                                    <li *ngIf="tableData?.canDelete" class="hover:bg-indigo-50 rounded-lg text-red-600" (click)="openConfirmModal(item)"><a>Delete</a></li>
                                    </ul>
                                </div>
                                <button *ngIf="!tableData?.dropMenu && tableData?.canEdit" class="py-1.5 px-5 rounded bg-indigo-50 text-indigo-700 hover:bg-indigo-100" (click)="openModal(item)">Edit</button>
                                <button *ngIf="!tableData?.dropMenu && tableData?.canDelete" class="py-1.5 px-2 rounded bg-red-50 text-red-700 hover:bg-red-100" (click)="openConfirmModal(item)">Delete</button>
                            </td>

                            <td *ngIf="tableData?.checkbox" class="whitespace-nowrap p-3 text-right text-xs font-medium space-x-2">
                                <input type="checkbox" [checked]="item.checked" [disabled]="!tableData?.edit" [name]="item.id" (change)="onCheckboxChange(item, $event)" [id]="item.id" class="accent-indigo-700 h-4 w-4 rounded-md">
                            </td>

                        </tr>

                        <tr *ngIf="tableData?.data?.length === 0">
                            <td colspan="100%" class="text-center text-gray-400 py-4">No data available</td>
                        </tr>      

                    </tbody>
    
                </table>

                <div *ngIf="tableData?.checkbox && (tableData?.data?.length > 0 || groupPersons?.length > 0)" class="w-full flex justify-end whitespace-nowrap p-3 text-right text-xs font-medium space-x-2">
                    <button *ngIf="!tableData?.edit" (click)="toggleEdit()" class="py-1.5 px-5 rounded bg-indigo-50 text-indigo-700 hover:bg-indigo-100">Edit</button>
                    <button *ngIf="tableData?.edit" (click)="cancelEdit()" class="py-1.5 px-2 rounded bg-red-50 text-red-700 hover:bg-red-100">Cancel</button>
                    <button *ngIf="tableData?.edit" (click)="openConfirmModal()" class="py-1.5 px-5 rounded bg-indigo-50 text-indigo-700 hover:bg-indigo-100">Save</button>
                </div>

            </div>
        </div>

    </div>

    <div *ngIf="tableData.type === 'detail_list'" class="w-full">
    
        <div class="bg-white rounded-xl shadow p-5 px-8">
    
            <div class="flex justify-between items-center pt-3 pb-8">

                <h2 class="text-lg font-semibold">{{tableData.tag | capitalizeWords}}s</h2>

                <div class="sm:mt-0 sm:ml-16 flex items-center space-x-4">

                    <!-- <app-download-button *ngIf="tableData?.canDownload" [downloadData]="downloadData"></app-download-button> -->
    
                    <button *ngIf="tableData?.canUpload" (click)="bulkUpload()" type="button" class="inline-flex items-center justify-center rounded-md border border-transparent bg-indigo-50 px-4 py-2 text-sm font-medium text-indigo-700 shadow-sm hover:bg-indigo-100 space-x-1 whitespace-nowrap focus:shadow-md">
                        <span class="text-2xl mr-1">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M9 8.25H7.5a2.25 2.25 0 0 0-2.25 2.25v9a2.25 2.25 0 0 0 2.25 2.25h9a2.25 2.25 0 0 0 2.25-2.25v-9a2.25 2.25 0 0 0-2.25-2.25H15m0-3-3-3m0 0-3 3m3-3V15" />
                            </svg>
                        </span>
                        <span class="mt-1">Bulk Upload</span>
                    </button>

                <button *ngIf="tableData?.canAdd" class="shadow-sm hover:shadow-md shadow-gray-400 bg-indigo-700 hover:bg-indigo-600 text-white text-sm px-3 py-2 rounded" (click)="openModal()">+ Add {{tableData.tag ?? 'New' | capitalizeWords}}</button>

                </div>
            </div>
    
            <div class="space-y-2">
                <div *ngFor="let item of tableData?.data" class="bg-gray-100 rounded p-3 pl-6 flex justify-between space-x-4">
                    
                    <div>
                        <p class="font-medium">{{ item.title }}</p>
                        <p class="text-sm text-gray-600">{{ item.message }}</p>
                    </div>

                    <div *ngIf="tableData?.dropMenu" class="dropdown dropdown-bottom dropdown-end">
                        <div tabindex="0" role="button" class="z-0 relative py-1.5 px-3 flex items-center whitespace-nowrap text-xs rounded bg-indigo-50 text-indigo-700 hover:bg-indigo-100">
                            Actions 
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 12.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5ZM12 18.75a.75.75 0 1 1 0-1.5.75.75 0 0 1 0 1.5Z" /></svg>
                        </div>
                        <ul tabindex="0" class="dropdown-content menu bg-white rounded-box z-50 w-32 p-2 shadow-sm text-xs">
                            <li class="hover:bg-indigo-50 rounded-lg" (click)="openModal(item, false)"><a>View</a></li>
                            <li *ngIf="tableData?.canEdit" class="hover:bg-indigo-50 rounded-lg" (click)="openModal(item)"><a>Edit</a></li>
                            <li *ngIf="tableData?.canDownload" class="hover:bg-indigo-50 rounded-lg" (click)="singleDownload(item)"><a>Download</a></li>
                            <li *ngIf="tableData?.canDelete" class="hover:bg-indigo-50 rounded-lg text-red-600" (click)="openConfirmModal(item)"><a>Delete</a></li>
                        </ul>
                    </div>

                </div>
            </div>
    
        </div>
    
    </div>
  
    <app-table-form-modal *ngIf="modalOpen" [formData]="formData" (cancel)="cancelEdit()" (save)="saveItem($event)" (close)="closeModal()"> </app-table-form-modal>

</div>
  